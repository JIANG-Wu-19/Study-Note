# SLAM

SLAM解决的问题：建图和定位

## 初识

**单目相机：**

- 丢失了深度
- 依靠**视差**来进行估算相对尺度
- 单目视觉无法只依靠图像确定这个真实尺度，成为**尺度不变性**

**双目视觉：**

- 精度一般，精度取决于标定和分辨率
- 计算量大



后端优化：主要用来处理SLAM过程中的噪声

回环检测（闭环检测）：主要解决位置估计随时间漂移的过程

度量地图：使用稀疏和稠密进行分类。稀疏地图进行了一定的抽象，并不需要表达所有的物体，例如：我们选择只保留一部分具有代表意义的东西（路标）

拓扑地图：只关注连通性，而不关注如何从A点到B点



## 旋转矩阵

#### 欧拉角

欧拉角使用**3个分离的转角**，把一个旋转分解成3次绕不同轴的旋转。

欧拉角的定义也非常的多，常见的一个定义是yaw-pitch-roll，他等价于ZYX轴的旋转

欧拉角的重大缺陷**万向锁问题**，当俯仰角为$$\pm90^\circ$$时，第一次旋转和第三次旋转会使用同一个轴，使得系统丢失了一个自由度。理论上可以证明，使用三个实数来表示三维旋转，就不可避免会出现奇异性问题，所以欧拉角不适合插值和跌倒。



综上：

1. 旋转矩阵用9个量表示3个自由度的旋转，冗余
2. 欧拉角存在奇异性 

所以我们提出了四元数

### 四元数

在二维情况下，旋转可以使用**单位复数**表示，三维旋转可以由**单位四元数**表示

一个四元数$$q$$由一个实部和三个虚部
$$
q=q_0+q_q\text{i}+q_2\text{j}+q_3\text{k}
$$
有时候也使用一个标量和一个向量来表示四元数
$$
q=[s,v]^T,\quad s=q_0\in \mathbb{R},\quad v=[q_1,q_2,q_3]^T\in \mathbb{R}^3
$$
s称为实部，v称为虚部

#### 四元数的运算

四元数和常见的复数一样，有四则运算，共轭、求逆、数乘等。现在有两个四元数$$q_a,q_b$$

**共轭**

四元数共轭是吧虚部取成相反数
$$
q^*_a=s_a-x_ai-y_aj-z_ak=[s_a,-v_a]^T
$$
四元数共轭与本身相乘，会得到实四元数
$$
q^*q=qq^*=[s^2_a+v^Tv,0]^T
$$


#### 用四元数表示旋转

假设一个空间三维点$$p=[x,y,z]\in\mathbb{R}^3$$，以及一个单位四元数q指定的旋转，使用四元数表示如下：

首先把三维空间点使用一个虚四元数表示：
$$
p=[0,x,y,z]^T=[0,v]^T
$$
相当于把四元数的3个虚部与空间中的3个轴对于，旋转后$$p'$$可表示为：
$$
q'=qpq^{-1}
$$
$$p'$$的虚部为旋转后坐标



#### 四元数到其他旋转表示的转换

结论：
$$
R=vv^T+s^2I+2s\hat v+(\hat v)^2
$$

$$
\theta=2\arccos s
$$





## 李群和李代数

旋转矩阵和变换矩阵对加法都不封闭

三维矩阵构成**特殊正交群**，变换矩阵构成**特殊欧式群**

群：有幺元，逆元，对一种算法封闭

**李群**指的是具有**连续性质的群**，刚体在三维空间的运动是连续的，所以他们都是李群

