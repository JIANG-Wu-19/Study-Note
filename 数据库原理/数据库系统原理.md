# 数据库系统原理

## 引言

#### 数据管理的阶段

- 人工管理
  - 纸质或者说物理方式
  - 容易丢数据
  - 数据重复
- 计算机出现以后，通过文件系统方式存储数据
  - 如今仍然使用文件方式保存
  - 不能实现记录和数据项的访问和共享，数据冗余大，利用率低
  - 数据孤立(data isolation)



#### 数据库系统的组成

- 数据库
  - 数据集文件
- 数据库管理系统（核心）
  - 专门描述、管理和维护数据库的系统
- 数据库应用程序
  - 允许用户开发数据库的工具




### 体系结构

#### 三级结构两级独立性

<img src="pics/image-20230530141853200.png" alt="image-20230530141853200" style="zoom:67%;" />

**内模式：**描述数据的实际存贮组织，内部记录组成，物理级数据库并不是真正的物理存贮，而是是最接近于物理存贮的级。

**概念模式：**数据库管理员看到的，是所有用户视图的最小并集

**外模式：**用户看到和使用的数据库，又称为用户视图，是用户所操作的



##### 数据视图

1. 物理层
2. 概念层
3. 用户层



物理独立性：隔离变化，底层数据的变化对于数据的使用者来说是不透明的

逻辑独立性：模式和外模式之间，是他们的映射转换实现逻辑独立性





#### 数据模型

- 关系模型
- 实体-联系模型
- 基于对象的数据模型



### 数据的存储和查询





## 设计理论1——关系模型与完整性
### ER模型

实体一般是长方形来体现，而属性则是椭圆形，关系则用菱形表示，关系也可能有属性

每个实体有一个键，唯一的确认实体





### 关系数据库

**关系->表**

**元组->行**

**属性->类**

**关键字->key**

**候选关键字：**
一个关系中，存在多个属性或属性组合都能唯一表示该元组，则称为候选关键字

**主关键字：**

候选关键字中的一个

**外部关键字：**

> 外键是关系模型中的一种约束，它用于建立和加强两个表数据之间的链接。一个表中的一个字段引用了另一个表中的主键，引用的表叫做子表，被引用的表叫做主表



### 关系数据模型完整性约束规则（必考）

- 完整性约束是关系数据库模型的重要组成部分 
  - 数据库管理系统通过对单个属性的取值范围、主关键字的属性以及属 性之间的关系加以制约（约束），以及提供对违反约束的处理过程 实现保证数据库的数据与现实世界的一致性。 

- 域完整性 
  - 属性取值必须取自于值域
  - 属性是否能取空值由其语义决定。域完整性是最基本的约束 

- 实体完整性
  - 主关键字值必须是唯一的且任何组成成份都不能是空值。 

- 引用／参考完整性 
  - 一用来保证表之间的关系的完整 

- 用户自定义完整性
  - 创建业务规则来确保值的有效性，从而使之落在需要范围之内





### 将实体联系模型转化为关系数据模型 

**规则1** 

- **每个实体类型转化为一个关系模式**，实体的属性转化为该为关系模式的属性：实体标识符（实体健）转化为该关系模式的键，每一个实体转化为该关系模式对应关系的一个元组。 

**规则2** 

- 实体类型间的每一个自身有属性的联系转化为一个关系模式，该联系的属性直接转化为该关系模式的属性，与该联系所关联的所有实体类型的实体键都转化为该关系模式的属性，共同组成该关系模式的主关键字。 

**规则3** 

- 若联系自身无属性

- 对1:N型联系，则1侧实体类型的实体健转化为属性加入到N侧实体类型 

- 对M:N型联系，则两侧实体类型的实体键都转化为属性，互相加入到对侧实体类型所转化后的关系模式中，和该关系模式的原主关键字一起，共同构成该关系模式新的主关键字；或者建立一个新关系模式关键字是关系的双方的主键共同组成（推荐后面这种）

- 对1:1型联系，则按1:N或M:N处理。



**简单说：**有属性的实体类型或者联系变成表，没有属性的联系将1的属性放到N中



### 范式：



### 判断候选码

1. 没在函数依赖集中，一定在候选中
2. 只在右边，一定不是候选
3. 只在左边，一定是候选
4. 能唯一的标识元组



## 视图

视图是一个不存在的表，其内容是由查询定义的

1. 集中用户的数据
2. 简化用户管理安全性
3. 隔离变化



## 考试

十个选择

四个简答

规范化题  主键 函数依赖关系 关键字

设计题  ER图

编程 SQL编程





