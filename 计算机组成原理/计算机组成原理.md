# 计算机组成原理



### 第五章 输入输出设备

#### 组成

##### I/O软件

1. 将数据输入主机
2. 将运算结果输送用户
3. 实现系统的协调



##### I/O硬件

接口模块和I/O硬件



#### 联系方式

##### 1.I/O设备编址方式

统一编址和不统一编址，统一编址将I/O设备看成存储器地址的一部分，不统一编址就是指I/O地址和存储器地址是分开的，所有对I/O设备的访问必须有专用的I/O指令。

统一编址占用了存储空间，减少了主存容量，但是无需专用的I/O指令。不统一编址由于不占用主存空间，故不影响主存容量，但需要I/O专用指令



##### 2.联络方式

1. 立即响应
2. 异步工作采用应答方式
3. 同步工作采用同步时标



##### 3.连接方式

辐射式和总线式



#### I/O设备与主机信息传送的控制方式

##### 1.程序查询方式

只要启动I/O设备，CPU就在不断查询能否读取数据，导致CPU原地踏步，不能继续执行程序，串行工作效率不高

##### 2.程序中断方式

CPU启动I/O设备后，不查询设备是否已就绪，继续执行自身的程序，只是当I/O设备准备就绪并向CPU发出中断请求后才予以响应

##### 3.DMA方式

主存和I\O设备中有一条数据通路，主存与I\O设备交换信息时，无须调用中断服务程序。若出现DMA和CPU同时访问主存，CPU总是将总线占有权让给DMA，通常把DMA的这种占有称为窃取或挪用。窃取的时间一遍为一个存储周期，故又把DMA占用的存储周期称为窃取周期



#### I/O接口

1.总线连接方式的I/O接口

数据线，设备选择线，命令线和状态线

I/O接口通常指的是主机与I/O设备之间设置的一个硬件电路及其相应的软件控制

端口是指接口电路中的一些寄存器，这些寄存器分别用来存放数据信息、控制信息和状态信息



##### 接口类型

按数据传送方式分类：并行接口和串行接口

按功能选择的灵活性分类：可编程接口和不可编程接口

按通用性分类有通用接口和专用接口

按数据传送的控制方式分类：程序型接口和DMA接口



#### 程序中断方式

##### 接口电路

1.中断请求触发器和中断屏蔽触发器

每一台外部设备必须配置一个中断请求触发器INTR，当其为1是，表示该设备向CPU发出请求。

能向CPU发出中断请求的我们都称之为中断源，当多个中断源向CPU提出请求中断请求时，CPU必须坚持一个原则



2.中断向量地址形成部件

CPU一旦想要了I/O中断，就要暂停现行程序，转而去执行该设备的中断服务程序

中断向量地址的形成部件的输入时来自排队其的输出IMTP1，INTP2...它的输出是中断向量，其位数与计算机可以处理中断源的个数有关，即一个中断源对应一个向量地址。

中断服务程序的地址入口是每个设备有不同的中断服务程序，每个服务程序都有一个入口地址，CPU必须要找到这个地址

CPU可以通过向量地址来寻找设备的中断服务程序入口地址





### 第六章 计算机的运算方法

#### 6.1 无符号数和有符号数

计算机中的数存储在寄存器中，通常称寄存器的位长为机器字长，无符号数和有符号数的范围不同

##### 有符号数

###### 整数原码定义：

$$
[x]_{源}=\begin{cases} 
0,x & 2^n>x\ge 0 \\
2^n-x & 0\ge x>-2^n
\end{cases}
$$



###### 小数原码定义：

$$
[x]_{源}=\begin{cases} 
x & 1>x\ge 0 \\
1-x & 0> x>-1
\end{cases}
$$

- 正数前面为0，负数前面为1



###### 整数补码

$$
[x]_补= \begin{cases} 
0,x & 2^n>x\ge0\\
2^n+x & 0>x> -2^n
\end{cases}
$$

###### 小数补码：

$$
[x]_补= \begin{cases} 
x & 1>x\ge0\\
2+x & 0>x\ge -1
\end{cases}
$$

- 正数前面为0，负数前面为1
- 后面用大一位的数字去减



###### 整数反码

$$
[x]_反= \begin{cases} 
0,x & 2^n>x\ge0\\
2^n-1+x & 0>x> -2^n
\end{cases}
$$

###### 小数反码

$$
[x]_补= \begin{cases} 
x & 1>x\ge0\\
2-2^{-n}+x & 0\ge x> -1
\end{cases}
$$

###### 总结：

- 最高位是符号位
- 值为正的时候，三者一样
- 值为负的时候，补码是原码“求反加一”，反码是原码“求反”



##### 移码表示法

存在移码的意义是因为，补码不能直观的比较大小

所以对补码加上$$2^n$$则转换为移码



#### 6.2数的定点表示和浮点表示

##### 定点表示

小数点位于数符和第一数值之间，当机器不是纯小数或纯整数时，必须乘上一个比例分子

##### 浮点表示

$$
N=S\times r^j
$$

S为尾数，J为阶码，r是基数

r可以取2，4，8

- r越大，可表示的浮点数范围越大
- r越大，精度越低

浮点数表示形式

|  阶符   |  阶码的数值部分  |  数符   |   尾数的数值部分    |
| :-----: | :--------------: | :-----: | :-----------------: |
| $$j_f$$ | $$j_1j_2...j_m$$ | $$S_f$$ | $$S_1S_2S_3...S_n$$ |

浮点表示转换，哪一部分是负的就转换哪一部分

注意阶移尾补

##### 机器零

- 尾数为0
- 阶数等于小于其最小数



#### 6.3 定点运算

算术移位规则

<img src="pics/image-20221014040929135.png" alt="image-20221014040929135" style="zoom:50%;" />

##### 加减运算

**1. 补码加减运算公式**

1）整数
$$
[A]_补+[B]_补=[A+B]_补 (mod2^{n+1})
$$
小数
$$
[A]_补+[B]_补=[A+B]_补 (mod2^{n})
$$

###### 减法 整数

$$
[A-B]_补=[A+(-B)]_补=[A]_补+[-B]_补 (mod2^{n+1})
$$

**连同符号位一起相加，然后去除符号位的进位**

###### 溢出判断

1位符号位：

通常用符号位产生的进位和最高有效位产生的进位异或操作，结果为1即溢出



2位符号位：

变形补码，将符号位变成两位，2位符号位连同数值一起参与运算，而且高位产生的进位自动丢失，即可得到正确结果

当2位符号位不同时溢出



##### 乘法运算：

移位相乘

###### 两位乘：



##### 除法运算：





##### 浮点四则运算：


