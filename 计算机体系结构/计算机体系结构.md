# 计算机体系结构

推荐书籍：

计算机体系结构（第二版） 清华大学出版社

John L. Hennessy, David A. Patternson; Computer Architecture: A Quantitative Approach; sixth Edition. 

David A. Patternson, John L. Hennessy ; Computer Organization and Design- The Hardware/Software Interface; RISC-V Edition.



参考书：

CSAPP



## 系统结构

**计算机性能提高的原因：**

- 科技
  - 更多晶体管
- 机器组织和实现
  - 更深的流水线
  - 更多并行执行
- 指令集架构
  - 精简指令集
  - 拓展
  - 显式并行



- IO原理
- 存储层次
- 流水线



机器使用多种不同形式的抽象，利用简单模型来隐藏实现的细节：

1. 指令集体系结构和指令集架构
2. 使用虚拟地址





### 计算机系统结构概念

#### 计算机系统结构

系统效率=min(器件速度)*min(系统结构效率)

![](assets/image-20230912151826216.png)

计算机体系结构是软件设计者与硬件设备设计者（VLSI）之间的中间层，是软件与硬件的接口（Interface）

> **基本定义：程序员所看到的计算机的属性，即概念性结构和功能特性。**



系统结构外特性--计算机系统的外观



#### 计算机分类方式

**并行度与并行体系分类**

1. 数据级并行
2. 任务级并行

计算机通过以下方式开发这两类应用并行：

1. **指令集并行**在编译器帮助下，利用流水线思想适度开发数据级并行
2. **向量体系结构和圄形处理器 (GPU)** 将单条指令并行应用于一个数据集
3. **线程级并行**在一种紧搞合硬件模型中开发数据级并行或任务级并行
4. 请求级并行在程序员或操作系统指定的大量去搞合任务之间开发并行



- 按处理机性能分类

  - 按大小分类：<font color= red>**巨型、大型、中型、小型、微型机**</font>
  - 按用途分：科学计算、事务处理、实时控制、工作站、服务器、家用计算机等。
  - 按数据类型分：定点计算机、浮点计算机、向量计算机、堆栈计算机等
  - 按处理机个数和种类划分：单处理机，并行处理机、多处理机、分布处理机，关联处理机
    超标量处理机, 超流水线处理机, VLIW处理机，SMP(对称多处理机)、MPP(大规模并行处理机)、机群(Cluster)系统等
  - 按所使用的器件划分：

- **基于流（Flynn分类法）**

  1. 模型中的重要概念

        指令流（Instruction Stream）：机器执行的指令序列；

        数据流（Data stream）：由指令处理的数据序列；

        多倍性（Multiplicity）：在系统最窄的部件上，处于同一执行阶段的指令和数据的最大可能个数。

  2. 模型中的基本模块

      MM（Memory Module）：内存模块。

      PU（Process Unit）：处理单元

      CU（Control Unit）：控制单元

  3. 按照指令流和数据流的多寡，Flynn将CA分成4种：

      1. 单指令流、单数据流(SISD)：单处理器
      2. 单指令流、多数据流(MISD)：同一指令由多个使用不同数据流的处理器执行。开发数据级并行
      3. 多指令流、单数据流 (MISD):  目前为止，还没有这种类型的商用多处理器，但包含这种类型之后，这种简单的分类方式变得更完整。
      4. 多指令流、多数据流 (MIMD): 每个处理器都提取自己的指令，对自己的数据进行操作，它针对的是任务级并行。


    缺点：
    
    (1)分类太粗
        在SIMD中包括有多种处理机
        对流水线处理机的划分不明确，
        标量流水线为SISD，向量流水线为SIMD
    
    (2)根本问题是把两个不同等级的功能并列对待
         数据流受指令流控制，造成MISD不存在
    
    (3)非冯计算机的分类？其他新型计算机的分类

- **库克分类法：**按控制流和执行流分类

    (1)单指令流单执行流
     SISE(Single Instruction Single Executionstream)，  典型的单处理机

    (2)单指令流多执行流
     SIME(Single Instruction Multiple Executionstream)
      多功能部件处理机、相联处理机、向量处理机、流水线处理机、超流水线处理机、超标量处理机、SIMD并行处理机

    (3)多指令流单执行流MISE
     (Multiple Instruction Single Execution stream)，  多道程序系统 

    (4)多指令流多执行流MIME
     (Multiple Instruction Multiple Execution stream)， 典型的多处理机

- 冯氏分类法

    以最大并行度作为系统结构分类的标准。

    所谓最大并行度Pm是指一个系统在单位时间内能够处理的最多的二进制位数，显然这是一个完全由计算机硬件结构决定的参数。

    最大并行度的数值越大越好。 







### 系统结构设计

#### 计算机系统设计思路

1. **由上向下方法**

   **适合于专用机的设计，从应用到实现级，周期几年。**

    **缺点：当应用对象或范围变化时，效率急剧下降。**

    **原因：软、硬件脱节，不能利用最新的软件技术。**

2. 由下向上方法

  前提：硬件不能改变。
  缺点：易形成软、硬脱节，软件不能获得最新硬件的支持，结果软件繁杂、效率低。



3. 从中间开始方法





抽象简化设计

善用并行性

可靠性法则：没有单点故障的设计。

数据和指令的重复性使用



